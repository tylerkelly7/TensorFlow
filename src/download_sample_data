"""
Downloads or prepares small image datasets for transfer learning.
Example: TensorFlow flower photos dataset.
"""

import tensorflow as tf
import os

def download_flowers_dataset(target_dir="data/raw/flowers"):
    os.makedirs(target_dir, exist_ok=True)
    dataset_url = "https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz"
    archive = tf.keras.utils.get_file(origin=dataset_url, fname="flower_photos.tgz", extract=True)
    extracted_path = os.path.join(os.path.dirname(archive), "flower_photos")
    print(f"[INFO] Dataset downloaded to: {extracted_path}")
    return extracted_path

if __name__ == "__main__":
    download_flowers_dataset()